На основе анализа теоретических аспектов военно-политических игр, возможностей и ограничений современных языковых моделей, а также существующих подходов к автоматизации геймплея, можно сформулировать комплексную задачу разработки мультиагентной текстовой стратегической игры на основе оркестрируемых языковых моделей. Данная глава детализирует функциональные и нефункциональные требования к разрабатываемой системе, описывает ключевых акторов и сценарии взаимодействия с системой, а также представляет архитектурные решения, обеспечивающие эффективное функционирование игры. Особое внимание уделяется специфике интеграции языковых моделей для автоматизации роли вердера с учетом выявленных ограничений и оптимальных методов их преодоления. Представленные в данной главе решения служат основой для последующей разработки как первичного прототипа системы, так и её улучшенной версии.
\subsection{Анализ требований пользователей}

Для разработки эффективной мультиагентной текстовой стратегической игры на основе оркестрируемых языковых моделей критически важно понимание ожиданий, предпочтений и потребностей целевой аудитории. В рамках исследования было проведено детальное интервьюирование потенциальных пользователей (подробные результаты представлены в Приложении~\ref{appendix:1}), что позволило выявить ключевые требования и сформировать целостное представление о желаемых характеристиках системы.

\subsubsection{Платформа и пользовательский интерфейс}

Анализ предпочтений пользователей относительно платформы проведения игры показал явное преобладание Telegram как предпочтительной платформы. Около 50\% респондентов однозначно высказались за использование данного мессенджера, аргументируя свой выбор удобством разметки, лучшей системой уведомлений и более интуитивным интерфейсом. Примерно 30\% опрошенных не выразили явных предпочтений между различными платформами, в то время как меньшинство (около 20\%) предпочли бы использование ВКонтакте.

Исходя из этих данных, Telegram определяется как основная платформа для разработки игрового интерфейса, с возможным последующим расширением на другие платформы.

\subsubsection{Монетизация и игровой темп}

Вопрос монетизации игры выявил значительную дифференциацию в готовности пользователей оплачивать игровые услуги:

\begin{itemize}
    \item Около 40\% опрошенных выразили готовность платить за игровые услуги в диапазоне от 300 до 2000 рублей в месяц, с преобладанием ценового диапазона 300-500 рублей.

    \item Оставшиеся 60\% предпочли бы бесплатный формат, с возможностью единоразовых пожертвований.
\end{itemize}

Анализ предпочтений относительно темпа игры выявил корреляцию между готовностью платить и желаемой частотой получения вердиктов. Пользователи, готовые платить большие суммы, ожидают более высокого темпа игры (до нескольких вердиктов в день), в то время как сторонники бесплатного формата удовлетворены более медленным темпом (около одного вердикта в день или реже).

На основе этих данных рекомендуется разработка многоуровневой системы монетизации:

\begin{enumerate}
    \item Бесплатный базовый уровень с ограниченным количеством вердиктов (1 в день или реже).

    \item Средний платный уровень (300-500 рублей в месяц) с умеренным темпом игры (2-3 верда в день).

    \item Премиум-уровень (1000-2000 рублей в месяц) с высоким темпом игры и дополнительными возможностями.
\end{enumerate}

\subsubsection{Игровые механики и особенности}

\paragraph{Отношение к элементам случайности}

Анализ отношения игроков к использованию случайности в игровом процессе выявил следующую картину:

\begin{itemize}
    \item Около 60\% респондентов выразили положительное отношение к включению элементов случайности в игровой процесс, предпочитая баланс между предопределенными результатами и случайными событиями. Многие указали на желательное соотношение 7:3, где 70\% результатов определяются действиями игрока, а 30\% — случайными факторами.

    \item Примерно 30\% выразили нейтральное отношение, не имея сильных предпочтений.

    \item Лишь 10\% участников высказались против использования случайности в игре, допуская её только в редких случаях (например, катаклизмы или чрезвычайные события).
\end{itemize}

Учитывая эти предпочтения, рекомендуется реализация настраиваемой системы случайности с возможностью регулирования её влияния на игровой процесс (параметр temperature в запросах к языковой модели) и обеспечения прозрачности в определении результатов действий.

\paragraph{Боевая система}

Предпочтения относительно боевой системы демонстрируют разнообразие подходов:

\begin{itemize}
    \item Большинство игроков предпочитают стратегический уровень принятия решений, где они определяют общие направления действий, а не управляют каждым юнитом напрямую.

    \item Некоторые игроки выразили желание иметь возможность выбора между детальным управлением и стратегическими приказами в зависимости от ситуации.

    \item Отдельные участники высказались за использование систем на основе кубиков (по аналогии с D\&D) для определения результатов сражений.
\end{itemize}

Оптимальным решением представляется создание гибкой боевой системы, позволяющей игрокам выбирать уровень детализации своего участия в военных действиях, с сохранением акцента на стратегических решениях и их нарративной интерпретации.

\paragraph{Визуализация и мультимедиа}

Относительно визуальных элементов игры выявлены следующие предпочтения:

\begin{itemize}
    \item Около 50\% респондентов проявили интерес к автоматической генерации изображений, иллюстрирующих значимые события и результаты действий.

    \item Большинство игроков (около 70\%) положительно отнеслись к использованию графиков и диаграмм для отображения экономических показателей, военной мощи и других количественных характеристик.

    \item Примерно 30\% опрошенных выразили интерес к функции расшифровки голосовых сообщений для упрощения коммуникации.
\end{itemize}

Рекомендуется внедрение опциональных визуальных элементов, дополняющих основной текстовый формат игры, с акцентом на информативности и эстетической ценности.

\subsubsection{Отношение к использованию языковых моделей}

Анализ отношения игроков к применению языковых моделей в роли вердера показал следующие результаты:

\begin{itemize}
    \item Около 40\% респондентов выразили положительное отношение к использованию ИИ для автоматизации вердинга, отмечая потенциальные преимущества в скорости и доступности.

    \item Примерно 30\% заняли нейтральную позицию, не видя принципиальных препятствий, но выражая определенные опасения относительно качества и последовательности генерируемого контента.

    \item Около 30\% высказали негативное отношение, опасаясь потери человеческого творческого элемента и уникального стиля, присущего человеку-вердеру.
\end{itemize}

Многие участники, независимо от общего отношения, выразили беспокойство относительно способности языковых моделей сохранять контекст игры, учитывать специфику игрового мира и обеспечивать последовательность нарратива. Часто высказывалось пожелание сохранить роль человека-администратора для надзора и корректировки действий ИИ.

\subsubsection{Коммуникационные предпочтения}

В вопросе организации коммуникации между игроками мнения разделились:

\begin{itemize}
    \item Около 60\% предпочитают общение через игрового бота, что обеспечивает сохранение всех коммуникаций в общем контексте игры и потенциально увеличивает иммерсивность.

    \item Примерно 40\% высказались за использование традиционных каналов коммуникации (групповые чаты, личные сообщения), обеспечивающих более непосредственное взаимодействие.
\end{itemize}

Некоторые игроки также выразили заинтересованность в механизмах, обеспечивающих анонимность коммуникации для предотвращения "метаигры" — ситуаций, когда личные отношения между игроками влияют на игровой процесс.

\subsubsection{Ключевые выводы и приоритетные требования}

На основе проведенного анализа можно сформулировать следующие ключевые требования к разрабатываемой системе:

\begin{enumerate}
    \item Реализация интерфейса на платформе Telegram с интуитивно понятной навигацией и системой уведомлений.

    \item Создание многоуровневой системы монетизации, обеспечивающей различные темпы игры в зависимости от выбранного тарифа.

    \item Внедрение настраиваемых элементов случайности с преобладанием детерминированных результатов, зависящих от действий игрока.

    \item Разработка гибкой боевой системы с акцентом на стратегическом уровне принятия решений.

    \item Интеграция визуальных элементов (графики, диаграммы, генерируемые изображения) как дополнение к основному текстовому контенту.

    \item Обеспечение механизмов сохранения контекста и последовательности игрового мира при использовании языковых моделей.

    \item Сохранение роли человека-администратора для надзора и корректировки автоматически генерируемого контента.

    \item Создание интегрированной системы коммуникации с возможностью выбора между игровыми и внеигровыми каналами общения.

    \item Разработка механизмов для баланса между автоматизацией и сохранением уникального игрового опыта.
\end{enumerate}

Эти требования являются фундаментом для дальнейшей разработки функциональных и нефункциональных спецификаций системы и определяют основные направления проектирования архитектуры мультиагентной системы для автоматизации ВПИ.

\subsection{Функциональные требования к системе}

На основе проведенного анализа требований пользователей и с учетом специфики военно-политических игр и возможностей современных языковых моделей, можно сформулировать следующие функциональные требования к разрабатываемой мультиагентной системе.

\subsubsection{Основные игровые функции}

\begin{enumerate}[label=FR\arabic*.]
    \item \textbf{Обработка приказов игроков:} Система должна принимать, обрабатывать и интерпретировать текстовые приказы игроков, направленные на управление виртуальным государством.

    \item \textbf{Генерация вердиктов:} Система должна генерировать содержательные, логически согласованные текстовые описания результатов выполнения приказов игроков с учетом текущего состояния игрового мира и механик игры.

    \item \textbf{Управление игровым миром:} Система должна поддерживать и обновлять состояние игрового мира, включая экономические показатели, военный потенциал, демографические характеристики и дипломатические отношения между государствами.

    \item \textbf{Симуляция проектов:} Система должна моделировать выполнение долгосрочных проектов, инициированных игроками (строительство инфраструктуры, разработка технологий и т.д.), с учетом имеющихся ресурсов и временных рамок.

    \item \textbf{Обработка военных действий:} Система должна моделировать сражения и военные кампании на основе приказов игроков, с учетом численности войск, их качества, тактических решений и географических условий.

    \item \textbf{Управление дипломатией:} Система должна обрабатывать дипломатические взаимодействия между государствами, включая заключение договоров, формирование альянсов, объявление войн и ведение переговоров.

    \item \textbf{Генерация игровых событий:} Система должна периодически создавать внутриигровые события (природные катаклизмы, восстания, культурные явления и т.д.) для обогащения игрового нарратива и создания новых вызовов для игроков.
\end{enumerate}

\subsubsection{Учетные записи и управление игрой}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Регистрация и аутентификация:} Система должна обеспечивать регистрацию новых игроков, аутентификацию существующих пользователей и управление игровыми сессиями.

    \item \textbf{Создание и настройка государства:} Система должна позволять игрокам создавать и настраивать виртуальные государства, определяя их географические, политические и экономические характеристики в соответствии с правилами игры.

    \item \textbf{Управление игровыми сессиями:} Система должна поддерживать механизмы создания новых игровых сессий, присоединения игроков к существующим сессиям и завершения игр.

    \item \textbf{Настройка игровых параметров:} Система должна позволять администраторам и, в определенных пределах, игрокам настраивать параметры игры, такие как скорость игрового времени, степень случайности и тематические ограничения.

    \item \textbf{Учет игровой активности:} Система должна отслеживать активность игроков для применения правил отсутствия (AFK) и автоматического управления неактивными государствами.
\end{enumerate}

\subsubsection{Мультиагентная обработка приказов}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Валидация приказов:} Система должна проверять соответствие приказов игроков установленным правилам, текущему технологическому уровню и имеющимся ресурсам.

    \item \textbf{Классификация приказов:} Система должна определять тип и сферу действия приказа (экономический, военный, дипломатический и т.д.) для его соответствующей обработки.

    \item \textbf{Проверка на соответствие эпохе:} Система должна оценивать соответствие приказов историческому или тематическому контексту игрового мира, предотвращая анахронизмы и нарушения жанровой целостности.

    \item \textbf{Оценка влияния на игровые параметры:} Система должна анализировать потенциальное влияние приказов на различные параметры государства (экономика, лояльность населения, военная мощь) и генерировать соответствующие изменения.

    \item \textbf{Разрешение конфликтов:} Система должна обеспечивать механизмы разрешения конфликтующих приказов разных игроков, особенно в ситуациях прямого противостояния.
\end{enumerate}

\subsubsection{Коммуникационные функции}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Внутриигровая переписка:} Система должна обеспечивать возможность обмена сообщениями между игроками с имитацией дипломатической переписки и сохранением в общем контексте игры.

    \item \textbf{Публичные объявления:} Система должна поддерживать функционал для публикации официальных заявлений государств, видимых всем участникам игры.

    \item \textbf{Секретные коммуникации:} Система должна обеспечивать возможность конфиденциальных переговоров между выбранными участниками, с опциональной возможностью перехвата при определенных игровых условиях.

    \item \textbf{Новостные сводки:} Система должна генерировать периодические новостные отчеты о ключевых событиях в игровом мире, доступные всем игрокам.
\end{enumerate}

\subsubsection{Визуализация и пользовательский интерфейс}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Игровая карта:} Система должна предоставлять интерактивную карту игрового мира с отображением государственных границ, ресурсов, военных подразделений и других релевантных объектов.

    \item \textbf{Экономические графики:} Система должна генерировать и отображать графики экономического развития государств, включая ключевые показатели (ВВП, уровень жизни, производственные мощности).

    \item \textbf{Военная статистика:} Система должна предоставлять визуализацию военного потенциала государств, включая численность войск, их качество и распределение.

    \item \textbf{Генерация изображений:} Система должна создавать иллюстрации к значимым событиям и результатам действий с использованием технологий генерации изображений.

    \item \textbf{Исторический журнал:} Система должна поддерживать хронологическую запись всех значимых игровых событий с возможностью просмотра и поиска.
\end{enumerate}

\subsubsection{Управление контекстом и состоянием игры}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Сохранение состояния игрового мира:} Система должна сохранять и обновлять полное состояние игрового мира, включая все государства, отношения между ними и глобальные параметры.

    \item \textbf{Резюмирование истории:} Система должна создавать и обновлять сжатые резюме исторического развития государств и мира в целом для эффективного использования ограниченного контекстного окна языковых моделей.

    \item \textbf{Извлечение релевантной информации:} Система должна эффективно извлекать информацию, релевантную для обработки конкретного приказа, из общего хранилища данных об игровом мире.

    \item \textbf{Обнаружение и коррекция несоответствий:} Система должна идентифицировать потенциальные логические несоответствия и противоречия в генерируемом контенте и предпринимать меры для их устранения.
\end{enumerate}

\subsubsection{Административные функции}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Мониторинг игрового процесса:} Система должна предоставлять инструменты для отслеживания общего состояния игры, активности игроков и потенциальных проблем.

    \item \textbf{Ручное вмешательство:} Система должна поддерживать механизмы для ручной корректировки автоматически генерируемого контента, разрешения спорных ситуаций и внесения изменений в игровой мир.

    \item \textbf{Управление параметрами ИИ:} Система должна предоставлять интерфейс для настройки параметров языковых моделей (температуры, предвзятости, максимальной длины ответа) для оптимизации качества генерируемого контента.

    \item \textbf{Журналирование и аудит:} Система должна вести детальный журнал всех значимых действий и операций для анализа, отладки и разрешения потенциальных споров.
\end{enumerate}

\subsubsection{Расширенные функции и монетизация}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Управление тарифными планами:} Система должна поддерживать различные уровни доступа с соответствующими ограничениями и возможностями в зависимости от выбранного игроком тарифа.

    \item \textbf{Обработка платежей:} Система должна обеспечивать безопасную обработку платежей для платных тарифов и учет финансовых транзакций.

    \item \textbf{Система достижений:} Система должна отслеживать игровые достижения пользователей и предоставлять соответствующие награды или признание.

    \item \textbf{Аналитика пользовательского опыта:} Система должна собирать и анализировать данные о пользовательском опыте для выявления проблемных аспектов и возможностей улучшения.

    \item \textbf{Расширенные инструменты для премиум-пользователей:} Система должна предоставлять дополнительные инструменты анализа, планирования и визуализации для пользователей премиум-тарифов.
\end{enumerate}

\subsubsection{Безопасность и этические аспекты}

\begin{enumerate}[label=FR\arabic*., resume]
    \item \textbf{Фильтрация неприемлемого контента:} Система должна выявлять и блокировать потенциально оскорбительный, вредоносный или неприемлемый контент в приказах игроков и коммуникациях.

    \item \textbf{Обеспечение конфиденциальности:} Система должна защищать конфиденциальность игровых взаимодействий и личных данных пользователей.

    \item \textbf{Предотвращение злоупотреблений:} Система должна включать механизмы для предотвращения злоупотреблений игровыми механиками и эксплуатации уязвимостей.

    \item \textbf{Соблюдение тематических ограничений:} Система должна обеспечивать соблюдение установленных тематических и жанровых ограничений игрового мира.
\end{enumerate}

Перечисленные функциональные требования формируют основу для проектирования архитектуры системы и разработки конкретных компонентов мультиагентной текстовой стратегической игры. Они будут дополнены и конкретизированы в процессе более детального проектирования отдельных модулей системы.

\subsection{Нефункциональные требования}

\subsection{Диаграмма прецедентов и сценарии использования}

\subsection{Требования к пользовательскому интерфейсу}

\subsection{Стратегия обработки ошибок и исключительных ситуаций}

\subsection{Масштабируемость и производительность}

\subsection{Этические аспекты и ограничения системы}